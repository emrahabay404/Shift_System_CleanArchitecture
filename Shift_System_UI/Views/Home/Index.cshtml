@using Shift_System.Domain.Entities.Models
@model TeamsModel


<h2>Dosya Yükle</h2>

<!-- Dosya Önizleme Alanı -->
<div id="filePreview" class="mb-3">
    <p>Dosya seçildiğinde burada önizleme gözükecek.</p>
</div>

<form id="uploadForm" enctype="multipart/form-data">
    <div class="form-group">
        <input type="file" style="width:20%" name="file" class="form-control" id="fileInput" accept="image/*,application/pdf" />
        <button type="button" class="btn btn-primary" onclick="uploadFile()">Yükle</button>
    </div>
</form>

<div id="message" class="mt-3"></div>


<form id="deleteFileForm">
    <input class="form-control" name="fileName" id="fileName" placeholder="Dosya adı ve uzantısı" />
    <button type="submit" class="btn btn-danger">Sil</button>
</form>



<div class="card">
    <div class="card-header">
        <h4 class="card-title">Home Index</h4>
    </div>
    <div class="card-body">
        <div class="table-responsive">
            <table id="multi-filter-select" class="display table table-striped table-hover">
                <thead>
                    <tr>
                        <th>Personel Kodu</th>
                        <th>Adı</th>
                        <th>Soyadı</th>
                        <th>Takım</th>
                        <th>Vardiya</th>
                        <th>Başlangıç Tarihi</th>
                        <th>Bitiş Tarihi</th>
                        <th>İşlemler</th>
                    </tr>
                </thead>
                <tfoot>
                    <tr>
                        <th>Personel Kodu</th>
                        <th>Adı</th>
                        <th>Soyadı</th>
                        <th>Takım</th>
                        <th>Vardiya</th>
                        <th>Başlangıç Tarihi</th>
                        <th>Bitiş Tarihi</th>
                        <th>İşlemler</th>
                    </tr>
                </tfoot>
                <tbody id="teamTableBody">
                    @foreach (var item in Model.Teams)
                    {
                        <tr>
                            <td>@item.PersonelKodu</td>
                            <td>@item.PersonelAdi</td>
                            <td>@item.PersonelSoyadi</td>
                            <td>@item.TakimAdi</td>
                            <td>@item.VardiyaAdi</td>
                            <td>@item.BaslangicTarihi</td>
                            <td>@item.BitisTarihi</td>
                            <td>
                                <div class="d-flex gap-2">
                                    <button class="btn btn-primary">  <i class="fas fas-lg fa-edit"></i></button>
                                    <button class="btn   btn-danger">  <i class="fas fas-lg fa-trash"></i></button>
                                </div>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
</div>


@section Scripts {
    <script src="~/js/homeindexcshtml.js"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $('#deleteFileForm').on('submit', function (e) {
                e.preventDefault(); // Sayfanın yeniden yüklenmesini engelle

                // Form verisini al
                var fileName = $('#fileName').val();

                // AJAX isteği
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("DeleteFile", "Home")', // Sunucuya istek yapılacak URL
                    data: { fileName: fileName }, // Form verisi
                    success: function (response) {
                        // Başarılı olduğunda kullanıcıya mesaj göster
                        if (response.success) {
                            alert("Dosya başarıyla silindi!");
                        } else {
                            alert("Hata: " + response.message);
                        }
                    },
                    error: function (xhr, status, error) {
                        alert("Bir hata oluştu: " + error);
                    }
                });
            });
        });
    </script>

}
